<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>AlgoHive – Strategy Factsheet</title>
    <script src="https://cdn.tailwindcss.com" nonce="ALGOHIVE"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <style>
        :root {
            --bg: #fff;
            --line: #e2e8f0;
            --ink: #0f172a;
            --olive: #556B2F
        }

        html,
        body {
            font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
            background: var(--bg);
            color: var(--ink)
        }

        .card {
            background: #fff;
            border: 1px solid var(--line);
            border-radius: 12px
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: .5rem;
            height: 40px;
            padding: 0 .875rem;
            border-radius: 10px;
            border: 1px solid var(--line);
            font-weight: 600
        }

        .input {
            height: 40px;
            border: 1px solid var(--line);
            border-radius: 10px;
            padding: 0 .75rem
        }

        .tab {
            height: 36px;
            border-radius: 8px;
            padding: 0 .75rem
        }

        .tab-active {
            background: #111827;
            color: #fff
        }

        /* UPDATED FOR RESPONSIVENESS */
        #layout {
            --sb: 220px;
            display: grid;
            grid-template-columns: 1fr;
            /* Mobile-first: 1 column */
            min-height: 100vh
        }

        #ah-sidebar {
            transition: transform .3s ease, width .2s ease;
            width: 280px;
            /* Mobile width */
            max-width: 85vw;
            position: fixed;
            /* Mobile overlay */
            z-index: 50;
            height: 100vh;
            transform: translateX(-100%);
            /* Hidden by default */
        }

        #ah-sidebar.is-open {
            transform: translateX(0);
            /* Show sidebar */
        }

        /* Desktop styles */
        @media (min-width: 768px) {
            #layout {
                grid-template-columns: var(--sb) 1fr
                    /* 2-col grid on desktop */
            }

            #layout.is-collapsed {
                --sb: 64px
            }

            #ah-sidebar {
                position: sticky;
                /* Back to sticky */
                top: 0;
                width: var(--sb);
                /* Use variable width */
                max-width: none;
                transform: translateX(0);
                /* Always visible */
                z-index: auto;
            }
        }

        /* END RESPONSIVE UPDATES */

        #layout.is-collapsed {
            --sb: 64px
        }

        #ah-sidebar[data-collapsed="true"] .label,
        #ah-sidebar[data-collapsed="true"] .chevron {
            display: none
        }

        #ah-sidebar details .sub {
            transition: height .2s ease
        }

        #ah-sidebar[data-collapsed="true"] details>.sub {
            display: none !important
        }

        #ah-sidebar .footer {
            transition: all .2s ease
        }

        #ah-sidebar[data-collapsed="true"] .btn-collapse :is(svg, i) {
            transform: rotate(180deg)
        }

        /* Hide desktop collapse button on mobile */
        #ah-collapse {
            display: none;
        }

        @media (min-width: 768px) {
            #ah-collapse {
                display: inline-flex;
            }

            /* Show on desktop */
        }

        .ps-tile {
            border: 1px solid #e5e7eb;
            border-radius: 14px;
            padding: 14px 16px;
            background: #fff
        }

        .ps-label {
            color: #64748b;
            font-weight: 500;
            font-size: .85rem
        }

        .ps-value {
            font-weight: 600;
            font-size: 1rem;
            margin-top: 2px
        }

        @keyframes ah-spin {
            to {
                transform: rotate(360deg)
            }
        }

        .spin i {
            animation: ah-spin .8s linear infinite
        }

        .cal-grid {
            display: grid;
            grid-auto-rows: minmax(36px, auto);
            gap: 0;
            border-collapse: collapse
        }

        /* --- REMOVED this incorrect rule ---
        .cal-grid>.cal-sticky {
            border-right: 0
        }
        */

        .cal-cell,
        .cal-head {
            border: 1px solid #e5e7eb;
            margin: 0
        }

        .cal-head.cal-sticky {
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: sticky;
            left: 0;
            background: var(--bg, #fff);
            z-index: 10;
            /* --- ADDED this border to fix visual glitch --- */
            border-right: 1px solid #e5e7eb;
        }

        /*
          Badge base styling — keep exactly as before.
          We'll apply risk-specific colours by adding a risk-* class to the same element.
        */
        .badge {
            display: inline-flex;
            align-items: center;
            gap: .5rem;
            padding: .35rem .65rem;
            border-radius: 999px;
            border: 1px solid #e5e7eb;
            font-size: .75rem;
            font-weight: 600;
            background: #fff;
            color: #0f172a;
            transition: background-color .15s ease, color .15s ease, border-color .15s ease;
        }

        /* Dynamic risk colour classes — override background, border color, and text color.
           Using .badge.risk-* to keep the base badge styling but swap full colours.
        */

        /* Conservative -> green */
        .badge.risk-conservative {
            background: #ecfdf5;      /* emerald-50 */
            border-color: #bbf7d0;    /* emerald-200 */
            color: #065f46;           /* emerald-800 */
        }

        /* Moderate -> orange */
        .badge.risk-moderate {
            background: #fff7ed;      /* orange/amber-50 */
            border-color: #fed7aa;    /* amber-200 */
            color: #b45309;           /* amber-700 */
        }

        /* High -> red */
        .badge.risk-high {
            background: #fff1f2;      /* rose-50 */
            border-color: #fecaca;    /* rose-200 */
            color: #dc2626;           /* rose-600 */
        }

        /* Very High -> stronger red */
        .badge.risk-very-high {
            background: #fee2e2;      /* rose-100 */
            border-color: #fecaca;    /* rose-200 */
            color: #991b1b;           /* rose-800 */
        }

        .legend-dot {
            width: 10px;
            height: 10px;
            border-radius: 9999px;
            display: inline-block
        }

        /* --- ADDED: Modal Styles --- */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 100;
            display: none;
        }

        .modal-content {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 12px;
            padding: 24px;
            z-index: 101;
            width: 90vw;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            display: none;
        }

        .modal-content.is-open,
        .modal-overlay.is-open {
            display: block;
        }

        .day-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
            text-align: center;
        }

        .day-grid-header {
            font-weight: 600;
            font-size: 0.75rem;
            color: #64748b;
            padding-bottom: 8px;
        }

        .day-grid-cell {
            font-size: 0.875rem;
            min-height: 48px;
            padding: 4px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
        }

        .day-grid-cell.is-empty {
            background: #f8fafc;
            border-color: transparent;
        }

        .day-grid-cell .day-num {
            font-weight: 600;
            color: #334155;
        }

        .day-grid-cell .day-pct {
            font-size: 0.8rem;
            font-weight: 500;
        }

        /* Logo fallback initials */
        .ph-logo-fallback {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            background: #e2e8f0;
            color: #64748b;
            font-weight: 600;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        /* Responsive list item */
        .ph-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 12px;
            border-bottom: 1px solid #f1f5f9;
        }

        .ph-item:last-child {
            border-bottom: none;
        }

        .ph-symbol {
            font-weight: 600;
            font-size: 0.875rem;
            min-width: 60px;
        }

        .ph-name {
            font-size: 0.875rem;
            color: #475569;
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .ph-weight {
            font-weight: 600;
            font-size: 0.875rem;
            color: #0f172a;
            min-width: 50px;
            text-align: right;
        }

        /* Top gainers carousel */
        .top-gainers-marquee {
            position: relative;
            overflow: hidden;
            width: 100%;
        }

        .top-gainers-marquee::-webkit-scrollbar {
            display: none;
        }

        .top-gainers-track {
            display: inline-flex;
            align-items: stretch;
            gap: 16px;
            min-width: max-content;
        }

        .top-gainers-track.is-looping {
            animation: tg-scroll var(--tg-duration, 24s) linear infinite;
        }

        .top-gainers-track.is-looping:hover {
            animation-play-state: paused;
        }

        .tg-card {
            min-width: 200px;
            max-width: 220px;
            padding: 16px;
            border-radius: 18px;
            border: 1px solid #e2e8f0;
            background: #ffffff;
            box-shadow: 0 10px 26px rgba(15, 23, 42, 0.08);
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .tg-card:hover {
            box-shadow: 0 12px 30px rgba(15, 23, 42, 0.12);
        }

        .tg-card-header {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .tg-card-meta {
            min-width: 0;
        }

        .tg-symbol {
            font-weight: 700;
            font-size: 0.95rem;
            color: #0f172a;
        }

        .tg-name {
            font-size: 0.75rem;
            color: #64748b;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 140px;
        }

        .tg-logo-img,
        .tg-logo-fallback {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .tg-logo-img {
            object-fit: contain;
            background: #ffffff;
        }

        .tg-logo-fallback {
            color: #475569;
            font-weight: 600;
            font-size: 0.75rem;
        }

        .tg-value {
            font-weight: 700;
            font-size: 1.05rem;
            color: #0f172a;
        }

        .tg-change {
            font-weight: 600;
            font-size: 0.85rem;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .tg-change.is-up {
            color: #16a34a;
        }

        .tg-change.is-down {
            color: #dc2626;
        }

        @keyframes tg-scroll {
            from {
                transform: translateX(0);
            }

            to {
                transform: translateX(-50%);
            }
        }

        @media (max-width: 640px) {
            .tg-card {
                min-width: 180px;
                max-width: 200px;
            }
        }

        @media (prefers-reduced-motion: reduce) {
            .top-gainers-track.is-looping {
                animation: none !important;
            }
        }

        /* --- END ADDED: Modal Styles --- */
    </style>
</head>


<body class="min-h-screen">
    <div id="layout">
        <div id="ah-overlay" class="fixed inset-0 bg-black/40 z-40 hidden md:hidden"></div>
        <aside id="ah-sidebar" data-collapsed="false"
            class="border-r border-slate-200 h-[100vh] bg-white flex flex-col overflow-hidden">
            <div class="px-4 py-4 flex items-center gap-3 border-b border-slate-200"> <img
                    src="https://static.wixstatic.com/media/ac771e_af06d86a7a1f4abd87e52e45f3bcbd96~mv2.png"
                    alt="AlgoHive Logo" class="w-10 h-10 object-contain" />
                <div class="min-w-0">
                    <div class="font-bold text-[15px] text-slate-900 label">AlgoHive</div>
                    <div class="text-[11px] text-slate-500 label">ID: <span id="sidebar-acc">—</span></div>
                </div>
            </div>
            <nav class="p-2 text-[14px] flex-1 overflow-y-auto"> <a
                    class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-50 font-medium text-slate-900 bg-slate-100"
                    href="home.html" title="Home"> <i class="fa-solid fa-house text-slate-500 w-4 shrink-0"></i><span
                        class="label">Home</span> </a>
                <details class="group mt-1">
                    <summary
                        class="flex items-center justify-between px-3 py-2 rounded-lg hover:bg-slate-50 cursor-pointer font-medium text-slate-900">
                        <span class="flex items-center gap-3"><i class="fa-regular fa-user w-4 text-slate-500"></i><span
                                class="label">Portfolio</span></span> <i
                            class="fa-solid fa-chevron-down text-slate-400 group-open:rotate-180 transition-transform chevron"></i>
                    </summary>
                    <div class="ml-8 mt-1 flex flex-col sub"> <a
                            class="px-3 py-2 rounded-lg hover:bg-slate-50 flex items-center gap-2"
                            href="my-strategies.html" title="Positions"><i
                                class="fa-solid fa-chart-pie w-4 text-slate-500"></i><span class="label">My
                                Strategies</span></a>
                    </div>
                </details>
                <details class="group mt-1">
                    <summary
                        class="flex items-center justify-between px-3 py-2 rounded-lg hover:bg-slate-50 cursor-pointer font-medium text-slate-900">
                        <span class="flex items-center gap-3"><i class="fa-solid fa-link w-4 text-slate-500"></i><span
                                class="label">Invest</span></span> <i
                            class="fa-solid fa-chevron-down text-slate-400 group-open:rotate-180 transition-transform chevron"></i>
                    </summary>
                    <div class="ml-8 mt-1 flex flex-col sub"> <a
                            class="px-3 py-2 rounded-lg hover:bg-slate-50 flex items-center gap-2"
                            href="strategies.html" title="OpenStrategies"><i
                                class="fa-solid fa-chart-line w-4 text-slate-500"></i><span
                                class="label">OpenStrategies</span></a>
                    </div>
                </details>
                <a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-50" href="support.html"
                    title="Support"><i class="fa-solid fa-life-ring w-4 text-slate-500"></i><span
                        class="label">Support</span></a> <a
                    class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-50" href="legal.html"
                    title="Legal"><i class="fa-solid fa-scale-balanced w-4 text-slate-500"></i><span
                        class="label">Legal</span></a>
            </nav>
            <div class="p-3 border-t border-slate-200 footer flex items-center justify-between gap-2"> <a
                    id="ah-settings" class="btn h-10 w-10 p-0 rounded-xl bg-slate-100 hover:bg-slate-200 border-0"
                    href="settings.html" title="Settings"><i class="fa-solid fa-gear"></i></a> <button id="ah-collapse"
                    class="btn h-10 w-10 p-0 rounded-xl bg-slate-100 hover:bg-slate-200 border-0" title="Collapse"><i
                        class="fa-solid fa-arrow-left"></i></button> </div>
        </aside>
        <main class="flex-1 min-w-0">
            <div class="flex items-center justify-between px-6 py-4 border-b border-slate-200 bg-white">
                <div class="flex items-center gap-3 flex-1 min-w-0">
                    <button id="ah-mobile-menu-btn" class="md:hidden btn h-10 w-10 p-0 rounded-xl border-0"
                        title="Open Menu">
                        <i class="fa-solid fa-bars"></i>
                    </button>
                </div>
                <div class="flex items-center gap-3"> <img id="hdr-avatar"
                        src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='36' height='36'><rect width='100%' height='100%' fill='%23f1f5f9'/></svg>"
                        alt="Profile" class="w-9 h-9 rounded-full object-cover border border-slate-200" />
                    <button id="hdr-profile-btn"
                        class="flex items-center gap-2 text-slate-900 font-medium hover:text-slate-700 min-w-0"><span
                            id="hdr-name" class="hidden sm:inline truncate">—</span><i
                            class="fa-solid fa-chevron-down text-slate-500 text-xs"></i></button>
                </div>
            </div>

            <div class="px-6 pt-5">
                <a href="strategies.html"
                    class="inline-flex items-center gap-2 text-sm font-medium text-slate-600 hover:text-[var(--olive)] transition-colors">
                    <i class="fa-solid fa-arrow-left text-xs"></i>
                    <span>Back to OpenStrategies</span>
                </a>
            </div>
            <div class="px-6 py-6 pt-2 grid grid-cols-12 gap-6 min-w-0">
                <section id="portfolio-card"
                    class="card border border-slate-200 shadow-none col-span-12 lg:col-span-9 min-w-0">
                    <div class="px-5 pt-5">
                        <div class="text-[12px] text-slate-500 font-semibold tracking-wide"> STRATEGY FACTSHEET <span
                                class="mx-1">•</span> <span id="fs-updated">Current Time —</span> </div>
                        <h1 class="text-2xl md:text-3xl font-extrabold mt-1 break-words" id="fs-title">-</h1>
                        <div class="mt-2 mb-3 flex flex-wrap items-center gap-2 text-slate-600" id="fs-badges"> <span
                                id="fs-provider">AlgoForge</span> <span class="mx-1 text-slate-400">•</span> <span>Live
                                since <span class="font-medium" id="fs-since">01/02/2021</span></span> <span
                                class="mx-1 text-slate-400">•</span>
                            <span id="fs-currency">ZAR</span> <span class="badge" id="fs-risk">Risk Moderate</span>
                        </div>
                    </div>
                    <div
                        class="flex flex-col sm:flex-row items-start sm:items-center sm:justify-between gap-y-3 sm:gap-y-0 px-5 py-4 border-t border-b border-slate-200">
                        <div>
                            <h3 class="font-normal text-slate-800">Equity Curve — <span id="pf-name"
                                    class="font-semibold">—</span>
                            </h3>
                            <div class="mt-1 text-sm text-slate-500" id="pf-updated">—</div>
                        </div>
                        <div class="flex items-center gap-2 flex-wrap">
                            <button data-range="1D" class="tab text-[13px]">1D</button>
                            <button data-range="1M" class="tab text-[13px]">1M</button>
                            <button data-range="3M" class="tab text-[13px]">3M</button>
                            <button data-range="6M" class="tab tab-active text-[13px]">6M</button>
                            <button data-range="YTD" class="tab text-[13px]">YTD</button>
                            <button data-range="1Y" class="tab text-[13px]">1Y</button>
                            <button data-range="3Y" class="tab text-[13px]">3Y</button>
                            <button data-range="ALL" class="tab text-[13px]">All</button>

                            <button id="pf-refresh"
                                class="ml-2 h-9 w-9 rounded-lg border border-slate-200 hover:bg-slate-50 grid place-items-center"
                                title="Refresh">
                                <i class="fa-solid fa-rotate-right"></i>
                            </button>
                        </div>




                    </div>
                    <div class="px-5 pt-4">
                        <div class="flex items-baseline gap-3">
                            <div class="text-2xl font-bold" id="pf-value">R 0.00</div>
                            <div class="text-lg font-normal" id="pf-change" data-sign="-"></div>
                        </div>
                    </div>
                    <div class="px-2 pb-4 pt-2">
                        <div class="h-[260px]">
                            <canvas id="pf-chart" class="max-w-full"></canvas>
                        </div>

                    </div>

                    <section class="card mx-5 mb-5 p-6">
                        <h3 class="text-lg font-medium text-slate-900 mb-2">Strategy Description</h3>
                        <p class="text-sm text-slate-700" id="fs-desc">-</p>
                        <ul class="list-disc pl-5 mt-2 text-sm text-slate-700" id="fs-desc-bullets">
                            <li>-</li>
                            <li>-</li>
                            <li>-</li>
                        </ul>
                    </section>
                </section>
                <aside class="col-span-12 lg:col-span-3 lg:row-span-5 grid gap-6 lg:sticky lg:top-4 self-start min-w-0">
                    <div class="card p-5 border border-slate-200">
                        <div class="flex items-center justify-between mb-3">
                            <h3 class="text-base font-medium text-slate-900">Allocate to Strategy</h3>
                        </div>
                        <div class="grid grid-cols-2 gap-3">
                            <div class="col-span-2"> <label class="block text-xs text-slate-500 mb-1.5"
                                    for="alloc-name">Strategy</label> <input id="alloc-name"
                                    class="h-9 w-full rounded-lg border border-slate-200 px-3 text-sm bg-slate-50"
                                    value="Trend Alpha" disabled /> </div>
                            <div> <label class="block text-xs text-slate-500 mb-1.5" for="alloc-price">Unit Price
                                    (ZAR)</label> <input id="alloc-price" type="number" step="0.01" value="1"
                                    class="h-9 w-full rounded-lg border border-slate-200 px-3 text-sm bg-slate-50"
                                    disabled /> </div>
                            <div> <label class="block text-xs text-slate-500 mb-1.5" for="alloc-units">Units</label>
                                <input id="alloc-units" type="number" min="1" value="1"
                                    class="h-9 w-full rounded-lg border border-slate-200 px-3 text-sm" />
                            </div>
                        </div>
                        <div class="mt-3 rounded-lg border border-slate-200 p-3 flex items-center justify-between">
                            <div class="text-xs text-slate-500">Total</div>
                            <div id="alloc-total" class="text-base font-semibold text-slate-900">R 1,124.00</div>



                        </div>
                        <div id="fx-note" class="mt-2 text-xs text-slate-500 hidden">
                            <span id="fx-pair">USD→ZAR</span> rate: <span id="fx-rate">—</span>
                            <span class="mx-1">•</span><span id="fx-updated">—</span>
                        </div>
                        <div class="mt-3 flex items-center justify-end gap-2"> <button id="alloc-btn"
                                class="btn bg-[var(--olive)] text-white border-none hover:opacity-90"> <i
                                    class="fa-solid fa-circle-plus"></i> Allocate </button> </div>
                        <div id="alloc-toast"
                            class="hidden mt-3 rounded-lg border border-emerald-200 bg-emerald-50 p-3 text-emerald-800 text-sm">
                            <i class="fa-solid fa-check mr-2"></i> Allocation submitted for <span
                                id="toast-strat">—</span>: <span id="toast-units">—</span> unit(s) @ <span
                                id="toast-price">—</span>.
                        </div>


                    </div>
                    <div class="card p-5 border border-slate-200">
                        <div class="flex items-center justify-between mb-3">
                            <h3 class="text-base font-medium text-slate-900">Asset class allocation</h3> <span
                                class="text-xs text-slate-500">Total = 100%</span>
                        </div>
                        <div class="space-y-4" id="asset-allocation"></div>
                    </div>
                    <div class="card p-5 border border-slate-200">
                        <div class="font-semibold mb-2">Strategy Overview</div>
                        <p id="fsDesc" class="text-sm text-slate-700">—</p>
                        <div class="grid grid-cols-2 gap-3 text-sm mt-3">
                            <div class="p-3 border rounded-xl">
                                <div class="text-slate-500 text-xs">Style</div>
                                <div id="fsStyle" class="font-semibold">—</div>
                            </div>
                            <div class="p-3 border rounded-xl">
                                <div class="text-slate-500 text-xs">Universe</div>
                                <div id="fsUniverse" class="font-semibold">—</div>
                            </div>
                            <div class="p-3 border rounded-xl">
                                <div class="text-slate-500 text-xs">Avg Holding</div>
                                <div id="fsHold" class="font-semibold">—</div>
                            </div>
                            <div class="p-3 border rounded-xl">
                                <div class="text-slate-500 text-xs">Trades / Month</div>
                                <div id="fsTrades" class="font-semibold">—</div>
                            </div>
                        </div>
                    </div>
                </aside>
                <section class="col-span-12 lg:col-span-9 min-w-0">
                    <div class="card p-6 rounded-2xl border border-slate-200 mb-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-medium text-slate-900">Daily Change</h3>
                            <span id="top-gainers-updated" class="text-xs text-slate-500 hidden"></span>
                        </div>
                        <div id="top-gainers-empty" class="text-sm text-slate-500 text-center py-6">
                            No daily change data yet.
                        </div>
                        <div id="top-gainers-marquee" class="top-gainers-marquee hidden">
                            <div id="top-gainers-track" class="top-gainers-track"></div>
                        </div>
                    </div>
                    <div class="card p-6 rounded-2xl border border-slate-200">
                        <h3 class="text-lg font-medium text-slate-900 mb-5">Performance Summary</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4">
                            <div class="ps-tile">
                                <div class="ps-label">Best Day</div>
                                <div id="ps-best" class="ps-value">+4.25%</div>
                            </div>
                            <div class="ps-tile">
                                <div class="ps-label">Worst Day</div>
                                <div id="ps-worst" class="ps-value">-2.67%</div>
                            </div>
                            <div class="ps-tile">
                                <div class="ps-label">Avg Daily Return</div>
                                <div id="ps-avg" class="ps-value">+0.12%</div>
                            </div>
                            <div class="ps-tile">
                                <div class="ps-label">Positive Days</div>
                                <div id="ps-pos" class="ps-value">61%</div>
                            </div>
                            <div class="ps-tile">
                                <div class="ps-label">Trading Days</div>
                                <div id="ps-days" class="ps-value">245</div>
                            </div>
                            <div class="ps-tile">
                                <div class="ps-label">YTD</div>
                                <div id="ps-ytd" class="ps-value">—</div>
                            </div>

                        </div>
                        <div class="mt-6">
                            <div class="flex items-center justify-between mb-2">
                                <div class="text-sm font-semibold text-slate-900">Calendar Returns</div>
                                <div class="flex flex-wrap items-center gap-x-3 gap-y-1 text-xs"> <span
                                        class="inline-block w-5 h-3 rounded" id="legNeg"></span><span
                                        class="text-slate-500">Negative</span> <span
                                        class="inline-block w-5 h-3 rounded" id="legNeu"></span><span
                                        class="text-slate-500">Flat</span>
                                    <span class="inline-block w-5 h-3 rounded" id="legPos"></span><span
                                        class="text-slate-500">Positive</span>
                                </div>
                            </div>
                            <div class="flex flex-col sm:flex-row items-stretch sm:items-center justify-end mb-2 gap-4">

                                <div class="relative flex items-center justify-end">
                                    <label class="text-sm font-medium text-slate-700 mr-2">Year:</label>
                                    <button id="year-filter-btn"
                                        class="input h-9 py-0 text-sm w-32 text-left flex justify-between items-center">
                                        <span id="year-filter-label" class="truncate">All Years</span>
                                        <i class="fa-solid fa-chevron-down text-xs mr-1"></i>
                                    </button>
                                    <div id="year-filter-popover"
                                        class="hidden absolute right-0 top-10 mt-1 w-48 bg-white border border-slate-200 rounded-lg shadow-lg z-10 p-4">
                                        <div class="space-y-2">
                                            <div>
                                                <input type="checkbox" id="year-all" class="year-filter-cb"
                                                    data-year="All" checked>
                                                <label for="year-all" class="ml-2 text-sm font-medium">All Years</label>
                                            </div>
                                            <hr class="my-2" />
                                            <div id="year-filter-list"
                                                class="grid grid-cols-2 gap-2 max-h-48 overflow-y-auto">
                                            </div>
                                            <button id="year-filter-apply"
                                                class="btn w-full bg-slate-800 text-white border-none h-8 text-sm mt-3 hover:bg-slate-700">Apply</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="relative flex items-center justify-end">
                                    <label class="text-sm font-medium text-slate-700 mr-2">Months:</label>
                                    <button id="month-filter-btn"
                                        class="input h-9 py-0 text-sm w-32 text-left flex justify-between items-center">
                                        <span id="month-filter-label" class="truncate">All Months</span>
                                        <i class="fa-solid fa-chevron-down text-xs mr-1"></i>
                                    </button>
                                    <div id="month-filter-popover"
                                        class="hidden absolute right-0 top-10 mt-1 w-48 bg-white border border-slate-200 rounded-lg shadow-lg z-10 p-4">
                                        <div class="space-y-2">
                                            <div>
                                                <input type="checkbox" id="month-all" class="month-filter-cb"
                                                    data-month="All" checked>
                                                <label for="month-all" class="ml-2 text-sm font-medium">All
                                                    Months</label>
                                            </div>
                                            <hr class="my-2" />
                                            <div class="grid grid-cols-2 gap-2">
                                                <div><input type="checkbox" id="month-Jan" class="month-filter-cb-ind"
                                                        data-month="Jan"><label for="month-Jan"
                                                        class="ml-2 text-sm">Jan</label></div>
                                                <div><input type="checkbox" id="month-Feb" class="month-filter-cb-ind"
                                                        data-month="Feb"><label for="month-Feb"
                                                        class="ml-2 text-sm">Feb</label></div>
                                                <div><input type="checkbox" id="month-Mar" class="month-filter-cb-ind"
                                                        data-month="Mar"><label for="month-Mar"
                                                        class="ml-2 text-sm">Mar</label></div>
                                                <div><input type="checkbox" id="month-Apr" class="month-filter-cb-ind"
                                                        data-month="Apr"><label for="month-Apr"
                                                        class="ml-2 text-sm">Apr</label></div>
                                                <div><input type="checkbox" id="month-May" class="month-filter-cb-ind"
                                                        data-month="May"><label for="month-May"
                                                        class="ml-2 text-sm">May</label></div>
                                                <div><input type="checkbox" id="month-Jun" class="month-filter-cb-ind"
                                                        data-month="Jun"><label for="month-Jun"
                                                        class="ml-2 text-sm">Jun</label></div>
                                                <div><input type="checkbox" id="month-Jul" class="month-filter-cb-ind"
                                                        data-month="Jul"><label for="month-Jul"
                                                        class="ml-2 text-sm">Jul</label></div>
                                                <div><input type="checkbox" id="month-Aug" class="month-filter-cb-ind"
                                                        data-month="Aug"><label for="month-Aug"
                                                        class="ml-2 text-sm">Aug</label></div>
                                                <div><input type="checkbox" id="month-Sep" class="month-filter-cb-ind"
                                                        data-month="Sep"><label for="month-Sep"
                                                        class="ml-2 text-sm">Sep</label></div>
                                                <div><input type="checkbox" id="month-Oct" class="month-filter-cb-ind"
                                                        data-month="Oct"><label for="month-Oct"
                                                        class="ml-2 text-sm">Oct</label></div>
                                                <div><input type="checkbox" id="month-Nov" class="month-filter-cb-ind"
                                                        data-month="Nov"><label for="month-Nov"
                                                        class="ml-2 text-sm">Nov</label></div>
                                                <div><input type="checkbox" id="month-Dec" class="month-filter-cb-ind"
                                                        data-month="Dec"><label for="month-Dec"
                                                        class="ml-2 text-sm">Dec</label></div>
                                            </div>
                                            <button id="month-filter-apply"
                                                class="btn w-full bg-slate-800 text-white border-none h-8 text-sm mt-3 hover:bg-slate-700">Apply</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="overflow-x-auto">
                                <div id="calendarReturns" class="cal-grid"></div>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="col-span-12 lg:col-span-9 min-w-0">
                    <div class="card p-6 rounded-2xl border border-slate-200 mb-6">
                        <div class="flex items-center justify-between mb-5">
                            <h3 class="text-lg font-medium text-slate-900">Portfolio Holdings</h3>
                            <div class="text-xs text-slate-500">Top 10 by weight</div>
                        </div>

                        <div id="ph-top10" class="mt-4 -mx-2"></div>
                    </div>

                    <div class="card p-6 rounded-2xl border border-slate-200 mb-6">
                        <h3 class="text-lg font-medium text-slate-900 mb-3">What fees can you expect</h3>
                        <ul class="space-y-2 text-sm text-slate-700">
                            <li class="flex flex-col sm:flex-row items-start gap-x-2">
                                <span class="font-semibold text-slate-900 sm:min-w-[160px]">Subscription</span>
                                <span>Intro promo: <strong>R299 / month</strong> (first 6 months)</span>
                            </li>
                            <li class="flex flex-col sm:flex-row items-start gap-x-2">
                                <span class="font-semibold text-slate-900 sm:min-w-[160px]">Management / AUM</span>
                                <span><strong>0%</strong> (we don’t charge AUM fees)</span>
                            </li>
                            <li class="flex flex-col sm:flex-row items-start gap-x-2">
                                <span class="font-semibold text-slate-900 sm:min-w-[160px]">Performance fee</span>
                                <span><strong>30%</strong> over High-Water Mark (example — adjust per strategy
                                    T&Cs)</span>
                            </li>
                            <li class="flex flex-col sm:flex-row items-start gap-x-2">
                                <span class="font-semibold text-slate-900 sm:min-w-[160px]">Funding / Payments</span>
                                <span>Standard Ozow processing costs may apply (pass-through).</span>
                            </li>
                            <li class="flex flex-col sm:flex-row items-start gap-x-2">
                                <span class="font-semibold text-slate-900 sm:min-w-[160px]">Withdrawals</span>
                                <span>AlgoHive withdrawal processing fees and/or third-party banking charges may
                                    apply.</span>
                            </li>
                        </ul>
                        <p class="text-xs text-slate-500 mt-3">Exact fees are strategy-specific. Always review the
                            strategy mandate before allocating.</p>
                    </div>

                    <div class="card p-6 rounded-2xl border border-slate-200">
                        <h3 class="text-lg font-medium text-slate-900 mb-2">Regulatory Disclaimer</h3>
                        <p class="text-sm text-slate-700">
                            Investing involves risk. Returns are not guaranteed and past performance is not a reliable
                            indicator of future results.
                            Nothing on this page constitutes financial advice. Products may be offered via an authorised
                            Financial Services Provider
                            in South Africa.
                        </p>
                    </div>
                </section>

            </div>
            <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
        </main>
    </div>

    <div id="daily-modal-overlay" class="modal-overlay"></div>
    <div id="daily-modal-content" class="modal-content">
        <div class="flex items-center justify-between mb-4">
            <h3 id="daily-modal-title" class="text-lg font-medium text-slate-900">Daily Returns</h3>
            <button id="daily-modal-close"
                class="h-8 w-8 rounded-full grid place-items-center hover:bg-slate-100 text-slate-500">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
        <div class="day-grid mb-2">
            <div class="day-grid-header">Sun</div>
            <div class="day-grid-header">Mon</div>
            <div class="day-grid-header">Tue</div>
            <div class="day-grid-header">Wed</div>
            <div class="day-grid-header">Thu</div>
            <div class="day-grid-header">Fri</div>
            <div class="day-grid-header">Sat</div>
        </div>
        <div id="daily-modal-grid" class="day-grid">
        </div>
    </div>

    <div id="profile-modal" class="fixed inset-0 z-[100] hidden">
        <div class="absolute inset-0 bg-black/40"></div>
        <div
            class="absolute right-6 top-20 w-64 rounded-2xl bg-white shadow-xl border border-slate-200 overflow-hidden">
            <div class="px-4 py-3 border-b border-slate-200">
                <div class="text-sm font-semibold text-slate-900">Account</div>
                <div id="pm-email" class="text-xs text-slate-500 truncate">—</div>
            </div>
            <div class="p-2"> <a id="pm-profile" href="/settings.html#basic"
                    class="w-full flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-slate-50"> <i
                        class="fa-regular fa-user text-slate-500 w-4"></i><span>Profile settings</span> </a> <button
                    id="pm-logout"
                    class="w-full flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-slate-50 text-rose-700"> <i
                        class="fa-solid fa-right-from-bracket w-4"></i><span>Log out</span> </button> </div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/js/all.min.js" defer
        nonce="ALGOHIVE"></script>
    <script
        nonce="ALGOHIVE"> (function () { const layout = document.getElementById('layout'); const aside = document.getElementById('ah-sidebar'); const btn = document.getElementById('ah-collapse'); cons[...] </script>

    <script nonce="ALGOHIVE">
        (function () {
            const btn = document.getElementById('ah-mobile-menu-btn');
            const overlay = document.getElementById('ah-overlay');
            const sidebar = document.getElementById('ah-sidebar');

            function openMenu() {
                sidebar.classList.add('is-open');
                overlay.classList.remove('hidden');
            }
            function closeMenu() {
                sidebar.classList.remove('is-open');
                overlay.classList.add('hidden');
            }

            btn?.addEventListener('click', openMenu);
            overlay?.addEventListener('click', closeMenu);

            sidebar?.querySelectorAll('nav a, nav details a').forEach(link => {
                link.addEventListener('click', closeMenu);
            });
        })();
    </script>

    <script type="module" nonce="ALGOHIVE">
        import { supabase } from "/js/supabase.js";
        let strategy = null;   // <— keep hoisted so handlers can see it
        let metrics = null;
        const MONTH_NAMES = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

        // *** ADDED: Daily Modal Function ***
        window.showDailyModal = function (year, monthName) {
            if (!metrics || !metrics.calendar_returns) {
                banner('Daily performance data is not available.', 'err');
                return;
            }
            // ... rest of your module code ...
        };
        // ... rest of your module code ...
    </script>

    <!--
      Dynamic risk badge helper (non-inline)
      - Keeps the exact badge base styling (.badge) but toggles a risk-* class
        which overrides background, border and text colour for the entire pill.
      - Supports: Conservative, Moderate, High, Very High (case-insensitive)
      - Exposes window.updateRiskBadge(riskString) for your module to call after loading strategy data.
      - Initializes from the current content of #fs-risk.
    -->
    <script nonce="ALGOHIVE">
        (function () {
            const el = document.getElementById('fs-risk');
            if (!el) return;

            // Normalize input string
            function normalize(s) {
                return (s || '').toString().trim().toLowerCase();
            }

            // Remove existing risk- classes (if any)
            function clearRiskClasses(node) {
                Array.from(node.classList).forEach(c => {
                    if (c.startsWith('risk-')) node.classList.remove(c);
                });
            }

            // Map risk text to precise class and display text
            function mapRisk(s) {
                const t = normalize(s);
                if (!t) return { cls: null, text: 'Risk —' };

                // match 'very high' before 'high'
                if (t.includes('very high') || t.includes('very-high') || t.includes('veryhigh')) {
                    return { cls: 'risk-very-high', text: 'Risk Very High' };
                }
                if (t.includes('high') || t.includes('aggress') || t.includes('aggressive')) {
                    return { cls: 'risk-high', text: 'Risk High' };
                }
                if (t.includes('moderate') || t.includes('medium') || t.includes('balanced')) {
                    return { cls: 'risk-moderate', text: 'Risk Moderate' };
                }
                if (t.includes('conserv') || t.includes('low')) {
                    return { cls: 'risk-conservative', text: 'Risk Conservative' };
                }

                // fallback: no class, preserve text (with Risk prefix if not present)
                const cleaned = s.toString().replace(/^risk\s*/i, '').trim();
                return { cls: null, text: cleaned ? ('Risk ' + cleaned) : 'Risk —' };
            }

            function setRisk(riskString) {
                const info = mapRisk(riskString);
                clearRiskClasses(el);

                if (info.cls) {
                    el.classList.add(info.cls);
                }
                // preserve the badge base class and update label
                el.classList.add('badge');
                el.textContent = info.text;
            }

            // initialize from current element text (in case markup contains "Risk Moderate")
            setRisk(el.textContent || el.innerText);

            // expose helper
            window.updateRiskBadge = setRisk;
        })();
    </script>

    <div id="daily-modal-overlay" class="modal-overlay"></div>
    <div id="daily-modal-content" class="modal-content"></div>
</body>

</html>
