<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MTC — Home</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    :root{ --hunter:#456243; --bg:#0f0f0f; --fg:#ffffff; --muted:#b6b6b6; --border:rgba(255,255,255,.18); }
    body{ background:#111; color:#fff; font-family:Poppins,system-ui; }

    /* ===== HEADER ===== */
    .main-header{ position:fixed; inset:0 0 auto 0; z-index:60; background:rgba(17,17,17,.72); border-bottom:1px solid var(--border); backdrop-filter:saturate(1.2) blur(10px); }
    .header-inner{ max-width:1280px; margin:0 auto; padding:.75rem 1rem; display:grid; grid-template-columns:auto 1fr auto; align-items:center; gap:1rem; }
    .logo-link{ display:flex; align-items:center; min-width:120px; }
    .header-logo{ height:34px; width:auto; display:block; }

    /* center nav on desktop */
    .header-nav{ display:none; justify-content:center; gap:.8rem; }
    @media (min-width:1024px){ .header-nav{ display:flex; } }

    .nav-pill{ display:inline-flex; align-items:center; gap:.5rem; padding:.55rem 1rem; border-radius:999px; font-weight:800; text-transform:lowercase; color:#e5e7eb; border:1.5px solid transparent; transition:.2s; }
    .nav-pill:hover{ color:#fff; background:rgba(255,255,255,.08); }
    .nav-pill.active{ color:#fff; border-color:var(--hunter); box-shadow:0 0 0 2px rgba(69,98,67,.25) inset; }

    .header-actions{ display:flex; align-items:center; gap:.75rem; justify-self:end; }
    .header-actions .fa-search{ color:var(--muted); }
    .nav-pill-auth{ border:2px solid #fff; color:#fff; padding:.5rem 1rem; border-radius:999px; font-weight:800; text-decoration:none; }
    .nav-pill-auth:hover{ background:rgba(255,255,255,.12); }

    .burger-btn{ width:42px; height:42px; display:grid; place-items:center; border:1px solid var(--border); border-radius:10px; background:transparent; color:#fff; }
    .burger-lines{ position:relative; width:18px; height:2px; background:#fff; }
    .burger-lines::before,.burger-lines::after{ content:""; position:absolute; left:0; width:18px; height:2px; background:#fff; }
    .burger-lines::before{ top:-6px } .burger-lines::after{ top:6px }
    @media (min-width:1024px){ .burger-btn{ display:none; } }

    /* ===== MOBILE OVERLAY MENU ===== */
    .mobile-overlay{ position:fixed; inset:0; z-index:70; display:none; background:rgba(10,10,10,.65); backdrop-filter:blur(16px) saturate(1.1); }
    .mobile-overlay.show{ display:block; }
    .mobile-sheet{ position:absolute; inset:0; padding:80px 16px 24px; overflow:auto; }
    .mobile-head{ position:fixed; top:8px; left:0; right:0; z-index:71; display:flex; align-items:center; justify-content:flex-end; gap:.5rem; padding:.5rem 12px; }
    .close-btn{ width:42px; height:42px; border-radius:10px; border:1px solid var(--border); background:rgba(255,255,255,.08); color:#fff; font-size:22px; }
    .mobile-menu{ display:grid; gap:.6rem; margin-top:8px; }
    .mobile-item{ display:flex; align-items:center; justify-content:space-between; padding:1rem 1rem; border-radius:12px; background:rgba(255,255,255,.06); border:1px solid var(--border); color:#fff; text-decoration:none; font-weight:800; }
    .mobile-auth{ margin-top:10px; display:block; text-align:center; font-weight:800; border:2px solid #fff; border-radius:999px; padding:.8rem 1.2rem; text-decoration:none; color:#fff; }
    .body-lock{ overflow:hidden; }

    /* ===== HERO ===== */
    .hero{ position:relative; padding-top:calc(64px + 2rem); }
    .hero-bg{ position:absolute; inset:0; background:url('https://images.unsplash.com/photo-1524985069026-dd778a71c7b4?q=80&w=1600') center/cover no-repeat; filter:brightness(.6); }
    .hero-mask{ position:absolute; inset:0; background:linear-gradient(180deg,rgba(0,0,0,.55),rgba(0,0,0,.35),rgba(0,0,0,.9)); }
    .hero-inner{ position:relative; z-index:1; max-width:1280px; margin:0 auto; padding:10vh 1rem 8vh; }
    .hero-title{ font-weight:800; font-size:clamp(1.6rem,4.5vw,3rem); line-height:1.12; margin-bottom:.5rem; }
    .hero-sub{ max-width:760px; color:#e5e7eb; opacity:.95; font-size:clamp(.95rem,1.6vw,1.1rem); }
    .hero-actions{ display:flex; gap:.75rem; margin-top:1rem; }
    .cta{ display:inline-flex; align-items:center; padding:.7rem 1rem; border-radius:999px; font-weight:800; text-decoration:none; }
    .cta-primary{ background:#fff; color:#000; }
    .cta-ghost{ color:#fff; border:1px solid var(--border); background:rgba(255,255,255,.06); }
    .me-2{ margin-right:.5rem; }

    /* ===== ROWS / CARDS (portrait 2:3 like Shows page) ===== */
    .rows{ max-width:1280px; margin:0 auto; padding:1.25rem 1rem 2.5rem; }
    .row{ margin-top:2rem; }
    .row-head{ display:flex; align-items:center; justify-content:space-between; margin-bottom:.75rem; }
    .row-title{ font-size:1.25rem; font-weight:800; letter-spacing:.2px; }
    .scroller{ position:relative; }
    .navbtn{ position:absolute; top:50%; transform:translateY(-50%); height:40px; width:40px; border-radius:999px; border:1px solid rgba(255,255,255,.2); background:rgba(17,17,17,.6); display:flex; align-items:center; justify-content:center; }
    .navbtn.left{ left:-10px } .navbtn.right{ right:-10px }

    .rail{
      display:grid;
      grid-auto-flow:column;
      grid-auto-columns:minmax(180px,1fr);
      gap:.7rem; overflow-x:auto; scroll-behavior:smooth; padding-bottom:.25rem;
    }
    @media (min-width:640px){ .rail{ grid-auto-columns:minmax(210px,1fr); } }
    @media (min-width:1024px){ .rail{ grid-auto-columns:minmax(230px,1fr); } }

    .show-card{ position:relative; border-radius:12px; overflow:hidden; background:rgba(255,255,255,.06); aspect-ratio:2/3; cursor:pointer; transition:transform .25s ease; }
    .show-card:hover{ transform:translateY(-3px); }
    .show-card img{ width:100%; height:100%; object-fit:cover; display:block; }
    .card-overlay{ position:absolute; inset:0; background:linear-gradient(to top,rgba(0,0,0,.85),transparent 55%); display:flex; align-items:flex-end; opacity:0; transition:opacity .25s; }
    .show-card:hover .card-overlay{ opacity:1; }
    .card-title{ color:#fff; font-weight:700; font-size:.95rem; padding:0 0.75rem 0.75rem; }

    /* ===== FOOTER ===== */
    .site-footer{ background:#456243; color:#f8fafc; margin-top:2rem; border-top:1px solid rgba(255,255,255,.18); }
    .site-footer .inner{ max-width:1280px; margin:0 auto; padding:2.5rem 1rem; }
    .footer-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:2rem; align-items:flex-start; }
    .footer-logo{ height:38px; filter:brightness(0) invert(1); display:block; margin-bottom:1rem; }
    .site-footer a{ color:#e8eef2; text-decoration:none; display:block; margin:.35rem 0; }
    .site-footer a:hover{ color:#ffffff; text-decoration:underline; }
    .footer-heading{ font-weight:800; margin-bottom:.6rem; }
    .footer-bottom{ border-top:1px solid rgba(255,255,255,.35); margin-top:1.25rem; padding-top:1rem; text-align:center; font-size:.9rem; color:#e8eef2; }
    .footer-social{ display:flex; gap:.75rem; font-size:1.2rem; }
    .footer-social a{ display:inline-flex; align-items:center; justify-content:center; width:36px; height:36px; border:1px solid rgba(255,255,255,.35); border-radius:999px; }
    .footer-social a:hover{ background:rgba(255,255,255,.12); }
  </style>
</head>
<body>

<!-- ===== HEADER ===== -->
<header class="main-header">
  <div class="header-inner">
    <a href="homepage.html" class="logo-link" aria-label="MTC Home">
      <img src="https://static.wixstatic.com/media/ac771e_aabe2d9b2d0c4638ba01d78c442e213e~mv2.png" alt="MTC Logo" class="header-logo">
    </a>

    <nav class="header-nav">
      <a href="homepage.html" class="nav-pill active" aria-current="page">home</a>
      <a href="shows.html" class="nav-pill">shows</a>
      <a href="live.html" class="nav-pill">live</a>
      <a href="mymtc.html" class="nav-pill">my mtc</a>
    </nav>

    <div class="header-actions">
      <i class="fa-solid fa-search hidden lg:inline"></i>
      <a href="auth.html" class="nav-pill-auth">sign up / in</a>
      <button id="burger" class="burger-btn" aria-label="Open menu" aria-expanded="false">
        <span class="burger-lines"></span>
      </button>
    </div>
  </div>
</header>

<!-- ===== MOBILE OVERLAY MENU ===== -->
<div id="mobileOverlay" class="mobile-overlay" aria-hidden="true">
  <div class="mobile-head">
    <button id="closeMenu" class="close-btn" aria-label="Close menu">&times;</button>
  </div>
  <div class="mobile-sheet">
    <nav class="mobile-menu">
      <a href="homepage.html" class="mobile-item"><span>home</span><i class="fa-solid fa-chevron-right"></i></a>
      <a href="shows.html" class="mobile-item"><span>shows</span><i class="fa-solid fa-chevron-right"></i></a>
      <a href="live.html" class="mobile-item"><span>live</span><i class="fa-solid fa-chevron-right"></i></a>
      <a href="mymtc.html" class="mobile-item"><span>my mtc</span><i class="fa-solid fa-chevron-right"></i></a>
      <a href="auth.html" class="mobile-auth">sign up / in</a>
    </nav>
  </div>
</div>

<!-- ===== HERO ===== -->
<section class="hero">
  <div class="hero-bg" id="hero-bg"></div>
  <div class="hero-mask"></div>
  <div class="hero-inner">
    <h1 class="hero-title" id="hero-title">Featured documentary</h1>
    <p class="hero-sub" id="hero-sub">Stories of faith, resilience, history, and community—curated for you.</p>
    <div class="hero-actions">
      <a class="cta cta-primary" id="hero-play" href="#"><i class="fa-solid fa-play me-2"></i>Play</a>
      <a class="cta cta-ghost" id="hero-more" href="#"><i class="fa-regular fa-circle-question me-2"></i>More Info</a>
    </div>
  </div>
</section>

<!-- ===== CONTENT ROWS ===== -->
<main class="rows" id="rows"></main>

<!-- ===== FOOTER ===== -->
<footer class="site-footer">
  <div class="inner">
    <div class="footer-grid">
      <div>
        <img src="https://static.wixstatic.com/media/ac771e_aabe2d9b2d0c4638ba01d78c442e213e~mv2.png" alt="MTC" class="footer-logo">
        <p>The mission of MTC is to create purposeful, engaging viewing and listening
           experiences that entertain, inspire, uplift, and improve families and communities.</p>
      </div>
      <div>
        <div class="footer-heading">Content</div>
        <a href="shows.html">Shows</a>
        <a href="live.html">Live</a>
        <a href="mymtc.html">My MTC</a>
      </div>
      <div>
        <div class="footer-heading">About</div>
        <a href="about.html">About MTC</a>
        <a href="#">Contact Us</a>
        <a href="#">Careers</a>
        <a href="#">Help</a>
      </div>
      <div>
        <div class="footer-heading">Connect</div>
        <div class="footer-social">
          <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
          <a href="#" aria-label="Twitter / X"><i class="fab fa-twitter"></i></a>
          <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
          <a href="#" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
        </div>
      </div>
    </div>
    <div class="footer-bottom">© 2025 Mountain Top Communications. All Rights Reserved.</div>
  </div>
</footer>

<!-- helpers -->
<script src="/js/supabase.js"></script>
<script src="/js/auth.js"></script>

<script>
  // ===== mobile menu
  const burger = document.getElementById('burger');
  const overlay = document.getElementById('mobileOverlay');
  const closer  = document.getElementById('closeMenu');
  function openMenu(){ overlay.classList.add('show'); burger.setAttribute('aria-expanded','true'); document.body.classList.add('body-lock'); }
  function closeMenu(){ overlay.classList.remove('show'); burger.setAttribute('aria-expanded','false'); document.body.classList.remove('body-lock'); }
  burger?.addEventListener('click', openMenu);
  closer?.addEventListener('click', closeMenu);
  overlay?.addEventListener('click', (e)=>{ if(e.target === overlay) closeMenu(); });

  // ===== data helpers
  const FALLBACK_IMG = 'https://images.unsplash.com/photo-1529101091764-c3526daf38fe?q=80&w=800&auto=format&fit=crop';

  async function fetchMedia(){
    try{
      if (!window.supabase) return { data: [], error: 'Supabase client not found' };
      // maps name -> title for UI
      const { data, error } = await supabase
        .from('media_content')
        .select('id, name as title, slug, description, poster_url, image_url, video_url, tags, age_rating, genre, type, show_id, created_at')
        .order('created_at', { ascending:false })
        .limit(250);
      return { data: data || [], error };
    }catch(err){
      return { data: [], error: err.message || err };
    }
  }

  // portrait card like Shows page
  function buildPortraitCard(item){
    const img = item.poster_url || item.image_url || FALLBACK_IMG;
    const div = document.createElement('div');
    div.className = 'show-card';
    div.innerHTML = `
      <img src="${img}" alt="${item.title}">
      <div class="card-overlay"><div class="card-title">${item.title}</div></div>
    `;
    div.querySelector('img').addEventListener('error', e => e.currentTarget.src = FALLBACK_IMG);
    div.addEventListener('click', ()=> location.href = \`engine.html?slug=\${encodeURIComponent(item.slug)}\`);
    return div;
  }

  function buildRow(title, items){
    if (!items?.length) return null;
    const row = document.createElement('section');
    row.className = 'row';
    row.innerHTML = `
      <div class="row-head">
        <h2 class="row-title">${title}</h2>
        <div class="text-sm text-white/70">
          <a href="shows.html?group=${encodeURIComponent(title)}" class="hover:underline">See all</a>
        </div>
      </div>
      <div class="scroller">
        <button class="navbtn left" aria-label="Scroll left"><i class="fa-solid fa-chevron-left"></i></button>
        <div class="rail"></div>
        <button class="navbtn right" aria-label="Scroll right"><i class="fa-solid fa-chevron-right"></i></button>
      </div>
    `;
    const rail = row.querySelector('.rail');
    items.forEach(it => rail.appendChild(buildPortraitCard(it)));

    const left = row.querySelector('.left'), right = row.querySelector('.right');
    const cardW = ()=> (rail.querySelector('.show-card')?.getBoundingClientRect().width || 220) + 12;
    left.addEventListener('click', ()=> rail.scrollBy({ left: -3*cardW(), behavior:'smooth' }));
    right.addEventListener('click',()=> rail.scrollBy({ left:  3*cardW(), behavior:'smooth' }));
    return row;
  }

  function setHeroFrom(items){
    const pick = items.find(x=> x.poster_url || x.image_url) || items[0];
    if (!pick) return;
    const bg   = document.getElementById('hero-bg');
    const ttl  = document.getElementById('hero-title');
    const sub  = document.getElementById('hero-sub');
    const play = document.getElementById('hero-play');
    const more = document.getElementById('hero-more');

    const img = pick.poster_url || pick.image_url || FALLBACK_IMG;
    bg.style.backgroundImage = \`url('\${img}')\`;
    ttl.textContent = pick.title || 'Featured';
    sub.textContent = pick.description || '';
    play.href = \`engine.html?slug=\${encodeURIComponent(pick.slug)}\`;
    more.href = \`engine.html?slug=\${encodeURIComponent(pick.slug)}&tab=about\`;
  }

  async function initHome(){
    const rowsEl = document.getElementById('rows');
    let { data, error } = await fetchMedia();

    // minimal fallback if DB empty
    if (error || !data.length){
      data = [
        // documentaries
        { title:"Pathway to Education: Breaking Ground in Ghana", slug:"pathway-to-education-ghana", description:"Impact of BYU–Pathway in Ghana.", poster_url:"https://brightspotcdn.byu.edu/dims4/default/b7dc590/2147483647/strip/true/crop/1707x1280+0+0/resize/800x600!/quality/90/?url=https%3A%2F%2Fbrigham-young-brightspot-us-east-2.s3.us-east-2.amazonaws.com%2F59%2F6a%2F20e0eafb3c13ffff0feb72f7ab2d%2Fthumbnail-img-5790-1707x1280.jpg", type:"documentary", genre:"Non-Fiction" },
        { title:"Rising from the ashes: Maui wildfire aftermath", slug:"maui-wildfire", description:"Students document Lahaina’s rebuilding.", poster_url:"https://brightspotcdn.byu.edu/dims4/default/0506f70/2147483647/strip/true/crop/960x720+160+0/resize/800x600!/quality/90/?url=https%3A%2F%2Fi.ytimg.com%2Fvi%2FnzByi1k-aF8%2Fmaxresdefault.jpg", type:"documentary", genre:"Non-Fiction" },
        // show episodes
        { title:"A Poor Wayfaring Man of Grief — Introduction", slug:"poor-wayfaring-intro", description:"Intro to the project.", type:"show", show_id:"poor-wayfaring", poster_url:null },
        { title:"A Poor Wayfaring Man of Grief — Verse 1", slug:"poor-wayfaring-verse-1", description:"Verse 1.", type:"show", show_id:"poor-wayfaring", poster_url:null },
        { title:"A Poor Wayfaring Man of Grief — Verse 2", slug:"poor-wayfaring-verse-2", description:"Verse 2.", type:"show", show_id:"poor-wayfaring", poster_url:null },
        { title:"A Poor Wayfaring Man of Grief — Verse 4", slug:"poor-wayfaring-verse-4", description:"Verse 4.", type:"show", show_id:"poor-wayfaring", poster_url:null },
        { title:"A Poor Wayfaring Man of Grief — Verse 5", slug:"poor-wayfaring-verse-5", description:"Verse 5.", type:"show", show_id:"poor-wayfaring", poster_url:null },
      ];
    }

    // hero cover from one of the cards
    setHeroFrom(data);

    // Row: Shows (episodes)
    const shows = data.filter(x => x.type === 'show');
    const showsRow = buildRow('Shows', shows);
    if (showsRow) rowsEl.appendChild(showsRow);

    // Row: Non-Fiction (you asked to group all documentaries here)
    const docs = data.filter(x => x.type === 'documentary');
    const nonFictionRow = buildRow('Non-Fiction', docs);
    if (nonFictionRow) rowsEl.appendChild(nonFictionRow);
  }

  initHome();
</script>

</body>
</html>
